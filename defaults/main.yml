---

lxd_bridgeconf_ipv4_addr: "10.252.116.1"
lxd_bridgeconf_ipv4_netmask: "255.255.255.0"
lxd_bridgeconf_ipv4_network: "10.252.116.1/24"
lxd_bridgeconf_ipv4_dhcp_range: "10.252.116.2,10.252.116.254"
lxd_bridgeconf_ipv4_dhcp_max: 252
lxd_bridgeconf_ipv4_nat: true

lxd_preloadimages:
    - { i: 'ubuntu:16.04', alias: 'ubuntu-16.04-nopython' }
    - { i: 'ubuntu:14.04', alias: 'ubuntu-14.04' }
    - { i: 'ubuntu:12.04', alias: 'ubuntu-12.04' }
    - { i: 'images:/centos/7/amd64', alias: 'centos-7-nossh' }
    - { i: 'images:/centos/6/amd64', alias: 'centos-6-nossh' }

lxd_shellcmds:
    - "lxc init centos-7-nossh default-centos-7"
    - "lxc start default-centos-7"
    - "lxc exec default-centos-7 -- dhclient eth0"
    - "lxc exec default-centos-7 -- ping -c 1 8.8.8.8"
    - "lxc exec default-centos-7 -- yum install -y openssh-server sudo"
    - "lxc exec default-centos-7 -- systemctl enable sshd"
    - "lxc exec default-centos-7 -- systemctl start sshd"
    - "lxc exec default-centos-7 -- mkdir /root/.ssh"
    - "openssl rand -base64 32 | lxc exec default-centos-7 -- passwd root --stdin"
    - "lxc stop default-centos-7 --force"
    - "lxc publish default-centos-7 --alias centos-7"
    - "lxc delete default-centos-7"

lxd_preconfigure: [
        { guest: 'default-ubuntu-1604', template: 'ubuntu-16.04-nopython', publishalias: 'ubuntu-16.04', shellcmds: [
            "dhclient eth0",
            "ping -c 1 8.8.8.8",
            "apt-get install -y python"
            ]
        },
        { guest: 'default-centos-7', template: 'centos-7-nossh', publishalias: 'centos-7', shellcmds: [
            "dhclient eth0",
            "ping -c 1 8.8.8.8",
## for some reason, lxc has http_proxy set: 'Could not resolve proxy: fe80::1%eth0]'
            "env http_proxy= yum install -y openssh-server sudo",
            "systemctl enable sshd",
            "systemctl start sshd",
            "mkdir /root/.ssh",
#            "openssl rand -base64 32 | passwd root --stdin"
            ]
        }
    ]
